{
  x86 One Byte Opcode Instructions
  TODO: refactoring, checking (este som s tymto nic nerobil po rozdeleni instrukcii do viac suborov)
}
const

  OneByte_InstructionSet: array [0..255] of TInstruction = (

  // $00-$0F
    (name: 'ADD'; opcode: $00; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'ADD'; opcode: $01; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'ADD'; opcode: $02; pc:2; param: (p1:GREGb; p2:MODb)),
    (name: 'ADD'; opcode: $03; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'ADD'; opcode: $04; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'ADD'; opcode: $05; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'PUSH'; opcode: $06; pc:1; param: (p1:ES)),
    (name: 'POP'; opcode: $07; pc:1; param: (p1:ES)),

    (name: 'OR'; opcode: $08; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'OR'; opcode: $09; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'OR'; opcode: $0A; pc:2; param: (p1:GREGb; p2:MODb)),
    (name: 'OR'; opcode: $0B; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'OR'; opcode: $0C; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'OR'; opcode: $0D; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'PUSH'; opcode: $0E; pc:1; param: (p1:CS)),
    (name: '2Byte'; opcode: $0F; pc:1; param: (p1:SS)),

  // $10-$1F
    (name: 'ADC'; opcode: $10; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'ADC'; opcode: $11; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'ADC'; opcode: $12; pc:2; param: (p1:GREGb; p2:MODb)),
    (name: 'ADC'; opcode: $13; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'ADC'; opcode: $14; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'ADC'; opcode: $15; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'PUSH'; opcode: $16; pc:1; param: (p1:SS)),
    (name: 'POP'; opcode: $17; pc:1; param: (p1:SS)),

    (name: 'SBB'; opcode: $18; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'SBB'; opcode: $19; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'SBB'; opcode: $1A; pc:2; param: (p1:GREGb; p2:MODb)),
    (name: 'SBB'; opcode: $1B; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'SBB'; opcode: $1C; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'SBB'; opcode: $1D; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'PUSH'; opcode: $1E; pc:1; param: (p1:DS)),
    (name: 'POP'; opcode: $1F; pc:1; param: (p1:DS)),

  // $20-$2F
    (name: 'AND'; opcode: $20; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'AND'; opcode: $21; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'AND'; opcode: $22; pc:2; param: (p1:GREGb; p2:MODb)),
    (name: 'AND'; opcode: $23; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'AND'; opcode: $24; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'AND'; opcode: $25; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'prefix'; opcode: $66; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'DAA'; opcode: $27; param:()),

    (name: 'SUB'; opcode: $28; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'SUB'; opcode: $29; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'SUB'; opcode: $2A; pc:2; param: (p1:GREGb; p2:MODb)),
    (name: 'SUB'; opcode: $2B; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'SUB'; opcode: $2C; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'SUB'; opcode: $2D; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'prefix'; opcode: $66; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'DAS'; opcode: $2F; param: ()),

  // $30-$3F
    (name: 'XOR'; opcode: $30; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'XOR'; opcode: $31; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'XOR'; opcode: $32; pc:2; param: (p1:GREGb; p2:MODb)),
    (name: 'XOR'; opcode: $33; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'XOR'; opcode: $34; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'XOR'; opcode: $35; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'prefix'; opcode: $66; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'AAA'; opcode: $37; pc:0;),

    (name: 'CMP'; opcode: $38; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'CMP'; opcode: $39; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'CMP'; opcode: $3A; pc:2; param: (p1:GREGb; p2:MODb)),
    (name: 'CMP'; opcode: $3B; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'CMP'; opcode: $3C; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'CMP'; opcode: $3D; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'prefix'; opcode: $66; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'AAS'; opcode: $3F; pc:0),

  // $40-$4F
    (name: 'INC'; opcode: $40; pc:1; param: (p1:AX)),
    (name: 'INC'; opcode: $41; pc:1; param: (p1:CX)),
    (name: 'INC'; opcode: $42; pc:1; param: (p1:DX)),
    (name: 'INC'; opcode: $43; pc:1; param: (p1:BX)),
    (name: 'INC'; opcode: $44; pc:1; param: (p1:SP)),
    (name: 'INC'; opcode: $45; pc:1; param: (p1:BP)),
    (name: 'INC'; opcode: $46; pc:1; param: (p1:SI)),
    (name: 'INC'; opcode: $47; pc:1; param: (p1:DI)),

    (name: 'DEC'; opcode: $48; pc:1; param: (p1:AX)),
    (name: 'DEC'; opcode: $49; pc:1; param: (p1:CX)),
    (name: 'DEC'; opcode: $4A; pc:1; param: (p1:DX)),
    (name: 'DEC'; opcode: $4B; pc:1; param: (p1:BX)),
    (name: 'DEC'; opcode: $4C; pc:1; param: (p1:SP)),
    (name: 'DEC'; opcode: $4D; pc:1; param: (p1:BP)),
    (name: 'DEC'; opcode: $4E; pc:1; param: (p1:SI)),
    (name: 'DEC'; opcode: $4F; pc:1; param: (p1:DI)),

  // $50-$5F
    (name: 'PUSH'; opcode: $50; pc:1; param: (p1:AX)),
    (name: 'PUSH'; opcode: $51; pc:1; param: (p1:CX)),
    (name: 'PUSH'; opcode: $52; pc:1; param: (p1:DX)),
    (name: 'PUSH'; opcode: $53; pc:1; param: (p1:BX)),
    (name: 'PUSH'; opcode: $54; pc:1; param: (p1:SP)),
    (name: 'PUSH'; opcode: $55; pc:1; param: (p1:BP)),
    (name: 'PUSH'; opcode: $56; pc:1; param: (p1:SI)),
    (name: 'PUSH'; opcode: $57; pc:1; param: (p1:DI)),

    (name: 'POP'; opcode: $58; pc:1; param: (p1:AX)),
    (name: 'POP'; opcode: $59; pc:1; param: (p1:CX)),
    (name: 'POP'; opcode: $5A; pc:1; param: (p1:DX)),
    (name: 'POP'; opcode: $5B; pc:1; param: (p1:BX)),
    (name: 'POP'; opcode: $5C; pc:1; param: (p1:SP)),
    (name: 'POP'; opcode: $5D; pc:1; param: (p1:BP)),
    (name: 'POP'; opcode: $5E; pc:1; param: (p1:SI)),
    (name: 'POP'; opcode: $5F; pc:1; param: (p1:DI)),

  // $60-$6F
    (name: 'PUSHA/PUSHAD'; opcode: $60; addop:true; name16:'PUSHA'; name32:'PUSHAD'),
    (name: 'POPA/POPAD'; opcode: $61; addop:true; name16:'POPA'; name32:'POPAD'),
{???} (name: 'BOUND'; opcode: $62; pc:2; param:(p1:GREGv; p2:MODv)),
    (name: 'ARPL'; opcode: $63; pc:2; param: (p1:MODw; p2:GREGw)),
    (name: 'prefix'; opcode: $66; pc:2; param: (p1:MODw; p2:GREGw)),
    (name: 'prefix'; opcode: $66; pc:2; param: (p1:MODw; p2:GREGw)),
    (name: 'prefix'; opcode: $66; pc:2; param: (p1:MODw; p2:GREGw)),
    (name: 'prefix'; opcode: $66; pc:2; param: (p1:MODw; p2:GREGw)),

    (name: 'PUSH'; opcode: $68; pc:1; param: (p1:IMMv)),
    (name: 'IMUL'; opcode: $69; pc:3; param: (p1:GREGv; p2:MODv; p3:IMMv)),
    (name: 'PUSH'; opcode: $6A; pc:1; param: (p1:IMMb)),
    (name: 'IMUL'; opcode: $6B; pc:3; param: (p1:GREGv; p2:MODv; p3:IMMb)),
    (name: 'INSB'; opcode: $6C),
    (name: 'INSW/INSD'; opcode: $6D; addop:true; name16:'INSW'; name32:'INSD'),
    (name: 'OUTSB'; opcode: $6E),
    (name: 'OUTSW/OUTSD'; opcode: $6F; addop:true; name16:'OUTSW'; name32:'OUTSD'),

// $70-$7F
    (name: 'JO';  opcode: $70; pc:1; param: (p1:RELb)),
    (name: 'JNO'; opcode: $71; pc:1; param: (p1:RELb)),
    (name: 'JB';  opcode: $72; pc:1; param: (p1:RELb)),
    (name: 'JNB'; opcode: $73; pc:1; param: (p1:RELb)),
    (name: 'JE';  opcode: $74; pc:1; param: (p1:RELb)),
    (name: 'JNE'; opcode: $75; pc:1; param: (p1:RELb)),
    (name: 'JNA'; opcode: $76; pc:1; param: (p1:RELb)),
    (name: 'JA';  opcode: $77; pc:1; param: (p1:RELb)),

    (name: 'JS';  opcode: $78; pc:1; param: (p1:RELb)),
    (name: 'JNS'; opcode: $79; pc:1; param: (p1:RELb)),
    (name: 'JP';  opcode: $7A; pc:1; param: (p1:RELb)),
    (name: 'JNP'; opcode: $7B; pc:1; param: (p1:RELb)),
    (name: 'JL';  opcode: $7C; pc:1; param: (p1:RELb)),
    (name: 'JNL'; opcode: $7D; pc:1; param: (p1:RELb)),
    (name: 'JLE'; opcode: $7E; pc:1; param: (p1:RELb)),
    (name: 'JG';  opcode: $7F; pc:1; param: (p1:RELb)),

  // $80-$8F
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'TEST'; opcode: $84; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'TEST'; opcode: $85; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'XCHG'; opcode: $86; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'XCHG'; opcode: $87; pc:2; param: (p1:MODv; p2:GREGv)),

    (name: 'MOV'; opcode: $88; pc:2; param: (p1:MODb; p2:GREGb)),
    (name: 'MOV'; opcode: $89; pc:2; param: (p1:MODv; p2:GREGv)),
    (name: 'MOV'; opcode: $8A; pc:2; param: (p1:GREGb; p2:MODb)),
    (name: 'MOV'; opcode: $8B; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'MOV'; opcode: $8C; pc:2; param: (p1:MODw; p2:SREGw)),
    (name: 'LEA'; opcode: $8D; pc:2; param: (p1:GREGv; p2:MODv)),
    (name: 'MOV'; opcode: $8E; pc:2; param: (p1:SREGw; p2:MODw)),
    (name: 'POP'; opcode: $8F; pc:1; param: (p1:MODv)),

  // $90-$9F
    (name: 'NOP'; opcode: $90; param: ()),
    (name: 'XCHG'; opcode: $91; pc:2; param: (p1:AX; p2:CX)),
    (name: 'XCHG'; opcode: $92; pc:2; param: (p1:AX; p2:DX)),
    (name: 'XCHG'; opcode: $93; pc:2; param: (p1:AX; p2:BX)),
    (name: 'XCHG'; opcode: $94; pc:2; param: (p1:AX; p2:SP)),
    (name: 'XCHG'; opcode: $95; pc:2; param: (p1:AX; p2:BP)),
    (name: 'XCHG'; opcode: $96; pc:2; param: (p1:AX; p2:SI)),
    (name: 'XCHG'; opcode: $97; pc:2; param: (p1:AX; p2:DI)),

    (name: 'CBW/CWDE'; opcode: $98; addop:true; name16:'CBW'; name32:'CWDE'),
    (name: 'CWD/CDQ'; opcode: $99; addop:true; name16:'CWD'; name32: 'CDQ'),
{???} (name: 'CALL'; opcode: $9A; pc:1; param: (p1: IMMp)),
    (name: 'WAIT'; opcode: $9B),
    (name: 'PUSHF/PUSHFD'; opcode: $9C; addop:true; name16:'PUSHF'; name32:'PUSHFD'),
    (name: 'POPF/POPFD'; opcode: $9D; addop:true; name16:'POPF'; name32:'POPFD'),
    (name: 'SAHF'; opcode: $9E; param: ()),
    (name: 'LAHF'; opcode: $9F; param: ()),

  // $A0-$AF
    (name: 'MOV'; opcode: $A0; pc:2; param: (p1:AL; p2:OFFb)),
    (name: 'MOV'; opcode: $A1; pc:2; param: (p1:AX; p2:OFFv)),
    (name: 'MOV'; opcode: $A2; pc:2; param: (p1:OFFb; p2:AL)),
    (name: 'MOV'; opcode: $A3; pc:2; param: (p1:OFFv; p2:AX)),
    (name: 'MOVSB'; opcode: $A4),
    (name: 'MOVSW/MOVSD'; opcode: $A5; addop:true; name16:'MOVSW'; name32:'MOVSD'),
    (name: 'CMPSB'; opcode: $A6),
    (name: 'CMPSW/CMPSD'; opcode: $A7; addop:true; name16:'CMPSW'; name32: 'CMPSD'),

    (name: 'TEST'; opcode: $A8; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'TEST'; opcode: $A9; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'STOSB'; opcode: $AA),
    (name: 'STOSW/STOSD'; opcode: $AB; addop:true; name16:'STOSW'; name32:'STOSD'),
    (name: 'LODSB'; opcode: $AC),
    (name: 'LODSW/LODSD'; opcode: $AD; addop:true; name16:'LODSW'; name32:'LODSD'),
    (name: 'SCASB'; opcode: $AE),
    (name: 'SCASW/SCASD'; opcode: $AF; addop:true; name16:'SCASW'; name32:'SCASD'),

  // $B0-$BF
    (name: 'MOV'; opcode: $B0; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'MOV'; opcode: $B1; pc:2; param: (p1:CL; p2:IMMb)),
    (name: 'MOV'; opcode: $B2; pc:2; param: (p1:DL; p2:IMMb)),
    (name: 'MOV'; opcode: $B3; pc:2; param: (p1:BL; p2:IMMb)),
    (name: 'MOV'; opcode: $B4; pc:2; param: (p1:AH; p2:IMMb)),
    (name: 'MOV'; opcode: $B5; pc:2; param: (p1:CH; p2:IMMb)),
    (name: 'MOV'; opcode: $B6; pc:2; param: (p1:DH; p2:IMMb)),
    (name: 'MOV'; opcode: $B7; pc:2; param: (p1:BH; p2:IMMb)),

    (name: 'MOV'; opcode: $B8; pc:2; param: (p1:AX; p2:IMMv)),
    (name: 'MOV'; opcode: $B9; pc:2; param: (p1:CX; p2:IMMv)),
    (name: 'MOV'; opcode: $BA; pc:2; param: (p1:DX; p2:IMMv)),
    (name: 'MOV'; opcode: $BB; pc:2; param: (p1:BX; p2:IMMv)),
    (name: 'MOV'; opcode: $BC; pc:2; param: (p1:SP; p2:IMMv)),
    (name: 'MOV'; opcode: $BD; pc:2; param: (p1:BP; p2:IMMv)),
    (name: 'MOV'; opcode: $BE; pc:2; param: (p1:SI; p2:IMMv)),
    (name: 'MOV'; opcode: $BF; pc:2; param: (p1:DI; p2:IMMv)),

  // $C0-$CF
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'RETN'; opcode: $C2; pc:1; param: (p1:IMMw)),
    (name: 'RETN'; opcode: $C3; ),
    (name: 'LES'; opcode: $C4; pc:2; param: (p1:GREGv; p2:MODp)),
    (name: 'LDS'; opcode: $C5; pc:2; param: (p1:GREGv; p2:MODp)),
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),

    (name: 'ENTER'; opcode: $C8; pc:2; param:(p1:IMMw; p2:IMMb)),
    (name: 'LEAVE'; opcode: $C9; param: ()),
    (name: 'RETF'; opcode: $CA; pc:1; param: (p1:IMMw)),
    (name: 'RETF'; opcode: $CB; ),
    (name: 'INT 3'; opcode: $CC; param:()),
    (name: 'INT'; opcode:   $CD; pc:1; param: (p1: IMMb)),
    (name: 'INTO'; opcode:  $CE; param: ()),
    (name: 'IRET/IRETD'; opcode: $CF; addop:true; name16: 'IRET'; name32: 'IRETD'),

  // $D0-$DF
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'group'; opcode: $FE; pc:1; param: (p1: IMMb)),
    (name: 'AAM'; opcode: $D4; pc:1; param: (p1: IMMb)),
    (name: 'AAD'; opcode: $D5; pc:1; param: (p1: IMMb)),
    (name: 'undefined opcode!'; opcode: $D6; pc:1; param: (p1: IMMb)),
    (name: 'XLAT/XLATB'; opcode: $D7),

    (name: 'fpu'; opcode: $D8; pc:1; param: (p1: IMMb)),
    (name: 'fpu'; opcode: $D8; pc:1; param: (p1: IMMb)),
    (name: 'fpu'; opcode: $D8; pc:1; param: (p1: IMMb)),
    (name: 'fpu'; opcode: $D8; pc:1; param: (p1: IMMb)),
    (name: 'fpu'; opcode: $D8; pc:1; param: (p1: IMMb)),
    (name: 'fpu'; opcode: $D8; pc:1; param: (p1: IMMb)),
    (name: 'fpu'; opcode: $D8; pc:1; param: (p1: IMMb)),
    (name: 'fpu'; opcode: $D8; pc:1; param: (p1: IMMb)),

  // $E0-$EF
    (name: 'LOOPNE'; opcode: $E0; pc:1; param: (p1:RELb)),
    (name: 'LOOPE';  opcode: $E1; pc:1; param: (p1:RELb)),
    (name: 'LOOP';   opcode: $E2; pc:1; param: (p1:RELb)),
    (name: 'JCXZ'; opcode: $E3; addop:true; name16: 'JCXZ'; name32: 'JECXZ'; pc:1; param:(p1: RELb;  )),
    (name: 'IN'; opcode: $E4; pc:2; param: (p1:AL; p2:IMMb)),
    (name: 'IN'; opcode: $E5; pc:2; param: (p1:AX; p2:IMMb)),
    (name: 'OUT'; opcode: $E6; pc:2; param: (p1:IMMb; p2:AL)),
    (name: 'OUT'; opcode: $E7; pc:2; param: (p1:IMMb; p2:AX)),

    (name: 'CALL'; opcode: $E8; pc:1; param: (p1: RELv)),
    (name: 'JMP'; opcode: $E9; pc:1; param: (p1:RELv)),
    (name: 'JMP'; opcode: $EA; pc:1; param: (p1:IMMp)),
    (name: 'JMP'; opcode: $EB; pc:1; param: (p1:RELb)),
    (name: 'IN'; opcode: $EC; pc:2; param: (p1:AL; p2:statDX)),
    (name: 'IN'; opcode: $ED; pc:2; param: (p1:AX; p2:statDX)),
    (name: 'OUT'; opcode: $EE; pc:2; param: (p1:statDX; p2:AL)),
    (name: 'OUT'; opcode: $EF; pc:2; param: (p1:statDX; p2:AX)),

  // $F0-$FF
    (name: 'prefix'; opcode: $66; pc:1; param: (p1: IMMb)),
    (name: 'undefined opcode'; opcode: $D6),
    (name: 'prefix'; opcode: $66; pc:1; param: (p1: IMMb)),
    (name: 'prefix'; opcode: $66; pc:1; param: (p1: IMMb)),
    (name: 'HLT'; opcode: $F4; param: ()),
    (name: 'CMC'; opcode: $F5; param:()),
    (name: 'group3'; opcode: $FE),
    (name: 'group3'; opcode: $FE),

    (name: 'CLC'; opcode: $F8; param:()),
    (name: 'STC'; opcode: $F9),
    (name: 'CLI'; opcode: $FA; param:()),
    (name: 'STI'; opcode: $FB),
    (name: 'CLD'; opcode: $FC; param:()),
    (name: 'STD'; opcode: $FD),
    (name: 'group4'; opcode: $FE),
    (name: 'group5'; opcode: $FE) // nemalo tu byt nahodou $FF - nie, $FE znamena ze je group instr., nie opcode
  );
